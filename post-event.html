<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Event - WashU Campus Events</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'washu-red': '#BA0C2F',
                        'washu-green': '#215732',
                        'washu-gray': '#3D3D3D',
                        'washu-tan': '#E1C4AC'
                    },
                    fontFamily: {
                        'sans': ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        .gothic-pattern {
            background-image: 
                linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%),
                linear-gradient(-45deg, rgba(255,255,255,0.1) 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, rgba(255,255,255,0.1) 75%),
                linear-gradient(-45deg, transparent 75%, rgba(255,255,255,0.1) 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }
        
        .form-input {
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            border-color: #BA0C2F;
            box-shadow: 0 0 0 3px rgba(186, 12, 47, 0.1);
        }
        
        .form-input.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }
        
        .image-preview {
            transition: all 0.3s ease;
        }
        
        .image-preview:hover {
            transform: scale(1.02);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .error-message {
            animation: slideIn 0.3s ease-out;
        }
        
        .success-message {
            animation: fadeIn 0.5s ease-in;
        }
        
        .char-count {
            transition: color 0.3s ease;
        }
        
        .char-count.warning {
            color: #f59e0b;
        }
        
        .char-count.error {
            color: #ef4444;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header Section -->
    <header class="bg-washu-red text-white py-8 relative overflow-hidden">
        <div class="gothic-pattern absolute inset-0 opacity-20"></div>
        <div class="container mx-auto px-4 relative z-10">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold">Post New Event</h1>
                    <p class="text-lg text-gray-100 mt-1">Share your event with the WashU community</p>
                </div>
                <button 
                    onclick="window.location.href='eventlist.html'"
                    class="bg-white text-washu-red px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors"
                >
                    ‚Üê Back to Events
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Success Message -->
        <div id="successMessage" class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6 hidden">
            <div class="flex items-center">
                <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span class="text-green-700 font-medium">Event posted successfully! Redirecting to events page...</span>
            </div>
        </div>

        <!-- Event Form -->
        <div class="bg-white rounded-lg shadow-lg p-8">
            <form id="eventForm" class="space-y-8">
                <!-- Basic Information Section -->
                <div>
                    <h2 class="text-xl font-bold text-washu-gray mb-6">Basic Information</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Event Name -->
                        <div class="lg:col-span-2">
                            <label for="eventName" class="block text-sm font-medium text-gray-700 mb-2">
                                Event Name <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="eventName"
                                placeholder="Enter event name"
                                class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                                required
                            >
                            <div id="eventNameError" class="error-message text-red-500 text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Location -->
                        <div>
                            <label for="location" class="block text-sm font-medium text-gray-700 mb-2">
                                Location <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="location"
                                placeholder="e.g., Brookings Hall"
                                class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                                required
                            >
                            <div id="locationError" class="error-message text-red-500 text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Category -->
                        <div>
                            <label for="category" class="block text-sm font-medium text-gray-700 mb-2">
                                Category <span class="text-red-500">*</span>
                            </label>
                            <select 
                                id="category"
                                class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                                required
                            >
                                <option value="">Select a category</option>
                                <option value="sports">Sports & Recreation</option>
                                <option value="academic">Academic & Learning</option>
                                <option value="social">Social & Networking</option>
                                <option value="arts">Arts & Culture</option>
                                <option value="outdoor">Outdoor Adventures</option>
                                <option value="wellness">Wellness & Fitness</option>
                            </select>
                            <div id="categoryError" class="error-message text-red-500 text-sm mt-1 hidden"></div>
                        </div>
                    </div>
                </div>

                <!-- Date & Time Section -->
                <div>
                    <h2 class="text-xl font-bold text-washu-gray mb-6">Date & Time</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Date -->
                        <div>
                            <label for="eventDate" class="block text-sm font-medium text-gray-700 mb-2">
                                Date <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="date" 
                                id="eventDate"
                                class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                                required
                            >
                            <div id="eventDateError" class="error-message text-red-500 text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Time -->
                        <div>
                            <label for="eventTime" class="block text-sm font-medium text-gray-700 mb-2">
                                Time <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="time" 
                                id="eventTime"
                                class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                                required
                            >
                            <div id="eventTimeError" class="error-message text-red-500 text-sm mt-1 hidden"></div>
                        </div>
                    </div>
                </div>

                <!-- Capacity & Image Section -->
                <div>
                    <h2 class="text-xl font-bold text-washu-gray mb-6">Event Details</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Max Capacity -->
                        <div>
                            <label for="maxCapacity" class="block text-sm font-medium text-gray-700 mb-2">
                                Max Capacity <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="number" 
                                id="maxCapacity"
                                min="1"
                                placeholder="e.g., 25"
                                class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                                required
                            >
                            <div id="maxCapacityError" class="error-message text-red-500 text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Cover Image -->
                        <div>
                            <label for="coverImage" class="block text-sm font-medium text-gray-700 mb-2">
                                Cover Image
                            </label>
                            <div class="space-y-3">
                                <input 
                                    type="file" 
                                    id="coverImage"
                                    accept="image/*"
                                    class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                                >
                                <div class="text-sm text-gray-500">
                                    Or enter image URL:
                                </div>
                                <input 
                                    type="url" 
                                    id="imageUrl"
                                    placeholder="https://example.com/image.jpg"
                                    class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                                >
                            </div>
                            <div id="coverImageError" class="error-message text-red-500 text-sm mt-1 hidden"></div>
                            
                            <!-- Image Preview -->
                            <div id="imagePreview" class="mt-3 hidden">
                                <img id="previewImg" src="" alt="Event preview" class="w-full h-48 object-cover rounded-lg image-preview">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Description Section -->
                <div>
                    <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                        Description <span class="text-red-500">*</span>
                    </label>
                    <textarea 
                        id="description"
                        rows="4"
                        maxlength="500"
                        placeholder="Describe your event in detail..."
                        class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none resize-none"
                        required
                    ></textarea>
                    <div class="flex justify-between items-center mt-2">
                        <div id="descriptionError" class="error-message text-red-500 text-sm hidden"></div>
                        <div id="charCount" class="char-count text-sm text-gray-500">0/500 characters</div>
                    </div>
                </div>

                <!-- Organizer Information Section -->
                <div>
                    <h2 class="text-xl font-bold text-washu-gray mb-6">Organizer Information</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Phone -->
                        <div>
                            <label for="organizerPhone" class="block text-sm font-medium text-gray-700 mb-2">
                                Phone Number
                            </label>
                            <input 
                                type="tel" 
                                id="organizerPhone"
                                placeholder="(XXX) XXX-XXXX"
                                class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none"
                            >
                            <div id="organizerPhoneError" class="error-message text-red-500 text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Email -->
                        <div>
                            <label for="organizerEmail" class="block text-sm font-medium text-gray-700 mb-2">
                                Email <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="email" 
                                id="organizerEmail"
                                value="john.doe@wustl.edu"
                                readonly
                                class="form-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg outline-none bg-gray-100 cursor-not-allowed"
                            >
                            <div class="text-sm text-gray-500 mt-1">Auto-filled from your account</div>
                        </div>
                    </div>
                </div>

                <!-- Form Buttons -->
                <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 sm:space-x-4 pt-6 border-t border-gray-200">
                    <button 
                        type="button"
                        id="cancelBtn"
                        class="w-full sm:w-auto px-8 py-3 bg-gray-500 text-white rounded-lg font-medium hover:bg-gray-600 transition-colors"
                    >
                        Cancel
                    </button>
                    <button 
                        type="submit"
                        class="w-full sm:w-auto px-8 py-3 bg-washu-red text-white rounded-lg font-medium hover:bg-red-700 transition-colors"
                    >
                        Submit Event
                    </button>
                </div>
            </form>
        </div>
    </main>

    <script>
        // Form elements
        const eventForm = document.getElementById('eventForm');
        const successMessage = document.getElementById('successMessage');
        const cancelBtn = document.getElementById('cancelBtn');

        // Initialize the page
        function init() {
            setupEventListeners();
            setMinDate();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Form submission
            eventForm.addEventListener('submit', handleSubmit);
            
            // Cancel button
            cancelBtn.addEventListener('click', handleCancel);
            
            // Image upload
            document.getElementById('coverImage').addEventListener('change', handleImageUpload);
            document.getElementById('imageUrl').addEventListener('input', handleImageUrl);
            
            // Description character count
            document.getElementById('description').addEventListener('input', updateCharCount);
            
            // Phone number formatting
            document.getElementById('organizerPhone').addEventListener('input', formatPhoneNumber);
            
            // Real-time validation
            document.getElementById('eventName').addEventListener('blur', () => validateRequired('eventName'));
            document.getElementById('location').addEventListener('blur', () => validateRequired('location'));
            document.getElementById('category').addEventListener('change', () => validateRequired('category'));
            document.getElementById('eventDate').addEventListener('change', validateDate);
            document.getElementById('eventTime').addEventListener('change', () => validateRequired('eventTime'));
            document.getElementById('maxCapacity').addEventListener('blur', validateCapacity);
            document.getElementById('description').addEventListener('blur', () => validateRequired('description'));
            document.getElementById('organizerPhone').addEventListener('blur', validatePhone);
        }

        // Set minimum date to today
        function setMinDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('eventDate').setAttribute('min', today);
        }

        // Handle form submission
        function handleSubmit(e) {
            e.preventDefault();
            
            // Clear previous errors
            clearAllErrors();
            
            // Validate all fields
            const isValid = validateAllFields();
            
            if (isValid) {
                // Simulate form submission
                console.log('Form submitted successfully');
                
                // Show success message
                successMessage.classList.remove('hidden');
                successMessage.classList.add('success-message');
                
                // Redirect after delay
                setTimeout(() => {
                    window.location.href = 'eventlist.html';
                }, 2000);
            }
        }

        // Handle cancel button
        function handleCancel() {
            if (confirm('Are you sure you want to cancel? Any unsaved changes will be lost.')) {
                window.location.href = 'eventlist.html';
            }
        }

        // Handle image upload
        function handleImageUpload(e) {
            const file = e.target.files[0];
            if (file) {
                // Check file size (5MB limit)
                if (file.size > 5 * 1024 * 1024) {
                    showError('coverImage', 'Image size must be less than 5MB');
                    return;
                }
                
                // Check file type
                if (!file.type.startsWith('image/')) {
                    showError('coverImage', 'Please select a valid image file');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    showImagePreview(e.target.result);
                };
                reader.readAsDataURL(file);
                
                hideError('coverImage');
            }
        }

        // Handle image URL input
        function handleImageUrl(e) {
            const url = e.target.value.trim();
            if (url) {
                showImagePreview(url);
            } else {
                hideImagePreview();
            }
        }

        // Show image preview
        function showImagePreview(src) {
            const preview = document.getElementById('imagePreview');
            const img = document.getElementById('previewImg');
            
            img.src = src;
            preview.classList.remove('hidden');
        }

        // Hide image preview
        function hideImagePreview() {
            const preview = document.getElementById('imagePreview');
            preview.classList.add('hidden');
        }

        // Update character count
        function updateCharCount(e) {
            const text = e.target.value;
            const charCount = document.getElementById('charCount');
            const count = text.length;
            
            charCount.textContent = `${count}/500 characters`;
            
            // Update color based on count
            charCount.classList.remove('warning', 'error');
            if (count > 450) {
                charCount.classList.add('warning');
            }
            if (count > 500) {
                charCount.classList.add('error');
            }
        }

        // Format phone number
        function formatPhoneNumber(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 6) {
                value = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6, 10)}`;
            } else if (value.length >= 3) {
                value = `(${value.slice(0, 3)}) ${value.slice(3)}`;
            }
            e.target.value = value;
        }

        // Validate all fields
        function validateAllFields() {
            let isValid = true;
            
            // Required fields
            const requiredFields = ['eventName', 'location', 'category', 'eventDate', 'eventTime', 'maxCapacity', 'description'];
            requiredFields.forEach(field => {
                if (!validateRequired(field)) {
                    isValid = false;
                }
            });
            
            // Additional validations
            if (!validateDate()) isValid = false;
            if (!validateCapacity()) isValid = false;
            if (!validatePhone()) isValid = false;
            
            return isValid;
        }

        // Validate required field
        function validateRequired(fieldId) {
            const field = document.getElementById(fieldId);
            const value = field.value.trim();
            
            if (!value) {
                showError(fieldId, 'This field is required');
                return false;
            } else {
                hideError(fieldId);
                return true;
            }
        }

        // Validate date
        function validateDate() {
            const dateField = document.getElementById('eventDate');
            const date = new Date(dateField.value);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            if (!dateField.value) {
                showError('eventDate', 'Date is required');
                return false;
            }
            
            if (date < today) {
                showError('eventDate', 'Event date cannot be in the past');
                return false;
            }
            
            hideError('eventDate');
            return true;
        }

        // Validate capacity
        function validateCapacity() {
            const capacityField = document.getElementById('maxCapacity');
            const value = parseInt(capacityField.value);
            
            if (!capacityField.value) {
                showError('maxCapacity', 'Capacity is required');
                return false;
            }
            
            if (value < 1) {
                showError('maxCapacity', 'Capacity must be at least 1');
                return false;
            }
            
            hideError('maxCapacity');
            return true;
        }

        // Validate phone number
        function validatePhone() {
            const phoneField = document.getElementById('organizerPhone');
            const value = phoneField.value.trim();
            
            if (value && !/^\(\d{3}\) \d{3}-\d{4}$/.test(value)) {
                showError('organizerPhone', 'Please enter a valid phone number');
                return false;
            }
            
            hideError('organizerPhone');
            return true;
        }

        // Show error message
        function showError(fieldId, message) {
            const errorElement = document.getElementById(`${fieldId}Error`);
            errorElement.textContent = message;
            errorElement.classList.remove('hidden');
            document.getElementById(fieldId).classList.add('error');
        }

        // Hide error message
        function hideError(fieldId) {
            const errorElement = document.getElementById(`${fieldId}Error`);
            errorElement.classList.add('hidden');
            document.getElementById(fieldId).classList.remove('error');
        }

        // Clear all errors
        function clearAllErrors() {
            const errorElements = document.querySelectorAll('[id$="Error"]');
            errorElements.forEach(element => {
                element.classList.add('hidden');
            });
            
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.classList.remove('error');
            });
        }

        // Initialize the page when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
